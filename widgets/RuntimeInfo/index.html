<!DOCTYPE html>
<html debug="false">
    <head>
        <link href="./main.css" rel="stylesheet" type="text/css"/>
		
		<!--<script type="text/javascript" src="http://getfirebug.com/releases/lite/1.2/firebug-lite-compressed.js"></script>-->
		
		<script type="text/javascript" src="https://code.jquery.com/jquery-2.2.2.min.js"></script>
    </head>
	
    <body class="noselect">
		<div class="container">
			<div class="title">JVM Runtime</div>
			<div class="info">
				<div class="row">
					<div class="label">Number of CPU's:</div><div id="numCpu" class="value">n/a</div>
				</div>
				<div class="row">
					<div class="label">Free memory:</div><div id="freeMemory" class="value">n/a</div>
				</div>
				<div class="row">
					<div class="label">Total memory:</div><div id="totalMemory" class="value">n/a</div>
				</div>
				<div class="row">
					<div class="label">Used memory:</div><div id="usedMemory" class="value">n/a</div>
				</div>
				<div class="row">
					<div class="label">Max memory:</div><div id="maxMemory" class="value">n/a</div>
				</div>
			</div>
		</div>
		
		<script>
			function jsBridgeReady() {
				window.setInterval(function() {
					update();
				}, 1000);
			}
			
			function update() {
				var runtimeInfo = JSON.parse(deskomatic.getRuntimeInfo());
				
				jQuery("#numCpu").text(runtimeInfo.numProcessors);
				jQuery("#totalMemory").text(toMB(runtimeInfo.totalMemory)+"MB");
				jQuery("#maxMemory").text(toMB(runtimeInfo.maxMemory)+"MB");
				jQuery("#freeMemory").text(toMB(runtimeInfo.freeMemory)+"MB");
				jQuery("#usedMemory").text(toMB(runtimeInfo.totalMemory - runtimeInfo.freeMemory)+"MB");
			}
			
			function toMB(bytes) {
				return (bytes / 1024.0 / 1024.0).toFixed(1);
			}
		</script>
	</body>
</html>