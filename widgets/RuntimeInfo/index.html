<!DOCTYPE html>
<html debug="false">
    <head>
        <link href="./main.css" rel="stylesheet" type="text/css"/>
		
		<!--<script type="text/javascript" src="http://getfirebug.com/releases/lite/1.2/firebug-lite-compressed.js"></script>-->
		
		<script type="text/javascript" src="https://code.jquery.com/jquery-2.2.2.min.js"></script>
    </head>
	
    <body class="noselect">
		<div class="container">
			<div class="title">DeskOMatic</div>
			<div class="info">
				<div>Number of CPU's: <span id="numCpu">n/a</span></div>
				<div>Free memory: <span id="freeMemory">n/a</span> MB</div>
				<div>Total memory: <span id="totalMemory">n/a</span> MB</div>
				<div>Used memory: <span id="usedMemory">n/a</span> MB</div>
				<div>Max memory: <span id="maxMemory">n/a</span> MB</div>
				<div>User time: <span id="userTime">n/a</span> Sec</div>
				<div>CPU time: <span id="cpuTime">n/a</span> Sec</div>
			</div>
		</div>
		
		<script>
			function jsBridgeReady() {
				window.setInterval(function() {
					update();
				}, 1000);
			}
			
			function update() {
				var runtimeInfo = JSON.parse(deskomatic.getRuntimeInfo());
				
				jQuery("#numCpu").text(runtimeInfo.numProcessors);
				jQuery("#totalMemory").text(toMB(runtimeInfo.totalMemory));
				jQuery("#maxMemory").text(toMB(runtimeInfo.maxMemory));
				jQuery("#freeMemory").text(toMB(runtimeInfo.freeMemory));
				jQuery("#usedMemory").text(toMB(runtimeInfo.totalMemory - runtimeInfo.freeMemory));
				
				if(runtimeInfo.cpuTime) {
					jQuery("#userTime").text(Math.round(runtimeInfo.userTime / 100000000) / 10);
					jQuery("#cpuTime").text(Math.round(runtimeInfo.cpuTime / 100000000) / 10);
				}
			}
			
			function toMB(bytes) {
				return Math.round(bytes / 1024.0 / 1024.0 * 10) / 10;
			}
		</script>
	</body>
</html>